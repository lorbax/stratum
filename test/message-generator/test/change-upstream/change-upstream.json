{
    "version": "2",
    "doc": [
        "This test does",
        "Launch a pool",
        "Launch jds",
        "Launch jdc",
        "Launch trnslator proxy",
        "Launch a mining device",
        "Act like a pool",
        "Connect jdc to this mock",
        "Receive an submit share error from this pool mock",
        "Close jdc connection with this pool",
        "Connect jdc the pool mocked by this test"
    ],
    "frame_builders": [
        {
            "type": "automatic",
            "message_id": "test/message-generator/messages/mining_messages.json::open_extended_mining_channel_success"
        },
        {
            "type": "automatic",
            "message_id": "test/message-generator/messages/common_messages.json::setup_connection_success_tproxy"
        },
        {
            "type": "automatic",
            "message_id": "test/message-generator/messages/mining_messages.json::set_custom_mining_job_success"
        },
        {
            "type": "automatic",
            "message_id": "test/message-generator/messages/mining_messages.json::submit_shares_error"
        }
    ],
    "actions": [
       {
            "message_ids": [],
            "role": "server",
            "results": [
                {
                    "type": "match_message_type",
                    "value": "0x00"
                }
            ],
            "actiondoc": "This action checks that a Setupconnection message is received"
        },
        {
            "message_ids": ["setup_connection_success_tproxy"],
            "role": "server",
            "results": [
                {
                    "type": "match_message_type",
                    "value": "0x13"
                }
            ],
          "actiondoc": "This action sends SetupConnection.Success and check that a SetCustomMiningJob is received"
        },
        {
            "message_ids": ["open_extended_mining_channel_success"],
            "role": "server",
            "results": [
                {
                    "type": "get_message_field",
                    "value": [
                        "MiningProtocol",
                        "SetCustomMiningJob",
                        [
                            [
                                "request_id",
                                "custom_job_req_id"
                            ]
                        ]
                    ]
                }
            ],
          "actiondoc": "This action sends open_extended_mining_channel_success, and a wait for a SetCustomMiningJoband get the req id"
        },
        {
            "message_ids": ["set_custom_mining_job_success"],
            "role": "server",
            "results": [
                {
                    "type": "match_message_type",
                    "value": "0x16"
                }
            ],
            "actiondoc": "This action sends a SetCustomMiningJob.Success and check that UpdateChannel is received"
        },
        {
            "message_ids": [],
            "role": "server",
            "results": [
                {
                    "type": "match_message_type",
                    "value": "0x1b"
                }
            ],
            "actiondoc": "This action sends a SetCustomMiningJob.Success and check that a ssubmit_shares is received"
        },
        {
            "message_ids": ["submit_shares_error"],
            "role": "server",
            "results": [],
            "actiondoc": "This action a submit_shares_error"
        }
    ],
    "setup_commands": [
    ],
    "execution_commands": [
    ],
    "cleanup_commands": [
        {
            "command": "sleep",
            "args": ["100000000000"],
            "conditions": "None"
        }
    ],
    "role": "server",
    "upstream": {
        "ip": "127.0.0.1",
        "port": 44254,
        "pub_key": "9auqWEzQDVyd2oe1JVGFLMLHZtCo2FFqZwtKA5gd9xbuEu7PH72",
        "secret_key": "mkDLTBBRxdBv998612qipDYoTK3YUrqLe8uWw7gu3iXbSrn2n"
    }
}
